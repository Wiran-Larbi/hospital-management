<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <record id="view_hospital_medical_record_form" model="ir.ui.view">
            <field name="name">hospital.medical_record.form</field>
            <field name="model">hospital.medical_record</field>
            <field name="arch" type="xml">
                <form string="Medical Record">
                    <header>
                        <button string="Print Prescription" type="object" name="print_prescription" class="btn-primary" />
                    </header>
                    <sheet>
                        <group>
                            <field name="patient_id"/>
                            <field name="doctor_id"/>
                            <field name="date"/>
                            <field name="diagnosis"/>
                            <field name="prescription"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="view_hospital_medical_record_tree" model="ir.ui.view">
            <field name="name">hospital.medical_record.tree</field>
            <field name="model">hospital.medical_record</field>
            <field name="arch" type="xml">
                <tree string="Medical Records">
                    <field name="patient_id"/>
                    <field name="doctor_id"/>
                    <field name="date"/>
                    <field name="diagnosis"/>
                    <field name="prescription"/>
                </tree>
            </field>
        </record>

        <report id="medical_record_pdf_report" model="hospital.medical_record" string="Prescription" report_type="qweb-pdf" name="hospital-management.report_medical_record_document" file="hospital-management.report_medical_record_document" print_report_name="'Prescription - %s' % (object.patient_id.name)" />
        <!-- QWeb Template for the Medical Record PDF report -->
        <template id="report_medical_record_document">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="hospital-management.medical_record_report"/>
                </t>
            </t>
        </template>
        <template id="medical_record_report">
            <t t-name="hospital-management.report_medical_record_document">
                <style>
            .page {
                font-family: 'Open Sans', sans-serif;
                color: #555;
            }
            .header {
                background-color : #BACBDE;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            .doctor-info h3 {
                flex-grow: 1;
                text-align: left;
            }
            .body {
                margin-top: 20px;
            }
            .footer {
                margin-top: 20px;
                text-align: center;
            }

                </style>
                <div class="page">
                    <div class="header">
                        <!-- Doctor's information -->
                        <div class="doctor-info">
                            <h3>Dr. <span t-field="doc.doctor_id.name"/>
                            </h3>
                            <p>
                                <strong>Specialization :</strong>
                                <span t-field="doc.doctor_id.specialization"/>
                            </p>
                        </div>
                        <div class="logo">
                            <img src="../logo.jpg" style="max-height: 100px;"/>
                        </div>
                    </div>
                    <h2>Medical Prescription :</h2>
                    <div class="body">
                        <p>Done at : <span t-field="doc.date"/>
                        </p>
                        <p>Full Name : <span t-field="doc.patient_id.name"/>
                        </p>
                        <p>
                            <strong>Diagnostic : </strong>
                            <span t-field="doc.diagnosis"/>
                        </p>
                        <!-- Prescription details -->
                        <p>
                            <strong>Prescription : </strong>
                            <pre t-field="doc.prescription"/>
                        </p>
                    </div>
                    <div class="footer">
                        <!-- Doctor's contact details -->
                        <div class="doctor-contact">
                            <p>
                                <strong>TÃ©l:</strong>
                                <span t-field="doc.doctor_id.contact"/>
                            </p>
                            <p>
                                <strong>Email:</strong>
                                <span t-field="doc.doctor_id.name"/>
@gmail.com</p>
                            <p>
                                <strong>Adresse:</strong>Hay moulay rachid 04 , Casablanca</p>
                        </div>
                    </div>
                </div>
            </t>
        </template>
        <record id="action_hospital_medical_records" model="ir.actions.act_window">
            <field name="name">Medical Records</field>
            <field name="res_model">hospital.medical_record</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                Create or view medical records here.
                </p>
            </field>
        </record>
    </data>
    <menuitem id="menu_hospital_medical_record" name="Medical Records" action="action_hospital_medical_records" parent="menu_hospital_main"/>
</odoo>
